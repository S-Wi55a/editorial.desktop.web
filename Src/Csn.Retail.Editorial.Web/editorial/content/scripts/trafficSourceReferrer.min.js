function TrafficSourceAttribution(n,t,i,r){var u=this,w="",s,l;t&&(w=";domain="+t.fpcdom);i=i||window;r=r||document;s=function(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r="[\\?&]"+n+"=([^&#]*)",u=new RegExp(r),t=u.exec(i.location.href);return t==null?"":t[1]};u.rhost=r.location.host;u.ref=r.referrer;l=s("testref");l&&(u.ref=decodeURIComponent(l));var f={},e={},a=0,v=["Direct to site","Paid search - Brand","Paid search - Generic","Organic search - Brand","Organic search - Generic","Social - Earned","Carsales Network","Other","Email - Newsletter","Email - Transactional","Display","Social - Content"],b=["bikesales","boatsales","carsales","caravancampingsales","quicksales","redbook","motoring","trucksales","carpoint","bikepoint","boatpoint","farmmachinerysales","constructionsales","livemarket","discountnewcars","homesales"],k=["AutoAlert","PriceAlert","PCAA","PCPA"],d=function(n){return n.replace(/^\s+|\s+$/g,"")},nt=function(){var n=u.ref.split("/");return n.length>=3?n[2].toLowerCase():null},tt=function(){var u=h("WT_AC"),t,i,r,n,f;if(a=0,u!="")for(t=u.split("|"),n=0,f=t.length;n<f;n++)i=t[n].split("."),r=Number(i[1]),e[i[0]]=r,a+=r},it=function(){var n=[],t;for(var i in e)n.push(i+"."+e[i]);t=n.join("|");y("WT_AC",t,u.cookieTime)},rt=function(){var t=0,i=0;for(var n in e)e[n]>i&&(i=e[n],t=n);return t},h=function(n){var u=r.cookie.split(";"),f="",t,e,i,o=u.length;if(r.cookie!="")for(i=0;i<o;i++)t=u[i].split("="),e=d(t[0]),e==n&&(f=decodeURIComponent(d(t.splice(1,t.length-1).join("="))));return f},y=function(n,t,i){var u="";i&&(u=";expires="+i.toGMTString());r.cookie=n+"="+t+u+w+";path=/"},g=function(n){var t=new Date,i=t.getTimezoneOffset()*6e4+36e6;return t.setTime(t.getTime()+i+n*1e3),t};u.isSocial=function(){var t=["facebook","twitter","youtube","bit"],n,i;if(!u.referringDomain)return!1;for(n=0,i=t.length;n<i;n++)if(u.referringDomain.indexOf(t[n])>=0)return!0;return!1};u.isSearch=function(){return u.ref.indexOf(".google.")>0||u.ref.indexOf(".bing.")>0&&u.ref.indexOf("?q=")>0||u.ref.indexOf(".yahoo.")>0&&u.ref.indexOf("p=")>0||u.ref.indexOf(".baidu.")>0&&u.ref.indexOf("?wd=")>0||u.ref.indexOf(".search.com")>0&&u.ref.indexOf("?q=")>0||u.ref.indexOf(".aol.")>0&&u.ref.indexOf("query=")>0||u.ref.indexOf(".ask.")>0&&u.ref.indexOf("?q=")>0};u.isPaid=function(){if(r.location||r.location.search){var n=r.location.search.toLowerCase();return n.indexOf("gclid")>0||n.indexOf("utm_source")>0}return!1};u.isCsNetwork=function(){var t=u.referringDomain,n,i;if(u.rhost.indexOf(t)==-1&&t)for(n=0,i=b.length;n<i;n++)if(t.indexOf(b[n].toLowerCase())>=0)return!0;return!1};u.isDirect=function(){return u.ref==""?!0:u.referringDomain&&u.rhost.indexOf(u.referringDomain)>-1?!0:!1};u.isBrand=function(){return n?n(u.ref):!1};u.isMarketingComs=function(){return u.seg4.indexOf("NEDM")!=-1||u.utm.indexOf("NEDM")!=-1?!0:!1};u.isSocialConent=function(){return u.seg4.indexOf("SCDD")!=-1||u.utm.indexOf("SCDD")!=-1?!0:!1};u.isProductComs=function(){for(var n=0,t=k.length;n<t;n++)if(u.seg4.indexOf(k[n])>=0)return!0;return!1};u.isDisplay=function(){return u.seg4!=""||u.utm!=""?!0:!1};u.isNewSessionWT=function(){var n=h("WT_FPC");if(n!=""){var t=Number(n.match(/lv=(.*):/i)[1])+864e5,i=g(0);return i>t}return!0};u.isNewSession=function(n,t){var i=u.isNewSessionWT();return window._tag&&window._tag.CSN&&window._tag.CSN.cdx&&window._tag.CSN.cdx.context.cdxOccurred?!1:n!=0&&n!=t?!0:i};u.getCurrentAttribution=function(){return u.isSearch()?u.isPaid()?u.isBrand()?1:2:u.isBrand()?3:4:u.isSocialConent()?11:u.isSocial()?5:u.isMarketingComs()?8:u.isProductComs()?9:u.isDisplay()?10:u.isDirect()?0:u.isCsNetwork()?6:7};u.referringDomain=nt();u.seg4=s("WT.seg_4");u.utm=s("utm_source");u.cookieTime=g(2592e3);try{tt();var o=h("WT_LA"),c=h("WT_FA"),p=u.getCurrentAttribution(),ut=u.isNewSession(p,o);f.isNewSession=!1;ut&&(o=p,c==""&&(c=p),e[o]?e[o]++:e[o]=1,f.isNewSession=!0);y("WT_LA",o,u.cookieTime);y("WT_FA",c,u.cookieTime);it();f.lastSeen=v[o];f.firstSeen=v[c];f.mostSeen=v[rt()];f.sessionCount=a;f.utm=u.utm;f.seg4=u.seg4}catch(ft){}return{context:f,debug:u}}
/*
//# sourceMappingURL=trafficSourceReferrer.min.js.map
*/